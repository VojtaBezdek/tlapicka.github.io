<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Tlapička.net</title><link href="http://www.tlapicka.net/" rel="alternate"></link><link href="http://www.tlapicka.net/feeds/python.atom.xml" rel="self"></link><id>http://www.tlapicka.net/</id><updated>2014-04-28T16:47:00+02:00</updated><entry><title>Výchozí kódování v Pythonu</title><link href="http://www.tlapicka.net/vychozi-kodovani-v-pythonu.html" rel="alternate"></link><updated>2014-04-28T16:47:00+02:00</updated><author><name>Marek Nožka</name></author><id>tag:www.tlapicka.net,2014-04-28:vychozi-kodovani-v-pythonu.html</id><summary type="html">&lt;p&gt;Občas se mi stane, že spouštím v Linuxu Python skript vytvořený ve Windows.
Nejčastěji je to nějaká studentská práce, domácí úkol nebo něco podobného.
Většinou není co řešit a program si prostě spustím, ale občas dělá problém
diakritika v unicode řetězcích.&amp;nbsp;Třeba:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="n"&gt;cislo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;u&amp;#39;napiš nějaké číslo&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;.....&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;pokus.txt&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;Loď čeří kýlem vodu v úžině&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;.....&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Python se snaží v těchto situacích unicode řetězec konvertovat do
příslušné znakové sady. Problém je, že neví, která znaková sada je ta
&amp;#8220;příslušná&amp;#8221; a proto končí s chybovým&amp;nbsp;hlášením:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gt"&gt;Traceback (most recent call last):&lt;/span&gt;
&lt;span class="err"&gt;File &amp;quot;kodovani.py&amp;quot;, line 30, in &amp;lt;module&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;    f.write(cestina)&lt;/span&gt;
&lt;span class="go"&gt;UnicodeEncodeError: &amp;#39;ascii&amp;#39; codec can&amp;#39;t encode character u&amp;#39;\u010f&amp;#39;&lt;/span&gt;
&lt;span class="go"&gt;in position 2: ordinal not in range(128)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Nejdřív to, co problémy nedělá: S tímto kódem problémy nejsou, protože kódování
pro standardní vstup/výstup je nastaveno na &lt;code&gt;UTF-8&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="s"&gt;&amp;quot;default encoding: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getdefaultencoding&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;cestina&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s"&gt;u&amp;#39;Loď v úžině&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;&lt;/span&gt;

&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="n"&gt;cestina&lt;/span&gt;              &lt;span class="c"&gt;# tohle je OK&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cestina&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c"&gt;# tohle taky&lt;/span&gt;
&lt;span class="c"&gt;# prototože&lt;/span&gt;
&lt;span class="k"&gt;print&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Pokud je třeba nějak měnit kódování standardního vstupu/výstupu je to možné
udělat jednoduše přes proměnnou prostředí &lt;code&gt;PYTHONIOENCODING&lt;/code&gt;. Výstup potom
vypadá&amp;nbsp;takto:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gp"&gt;$&lt;/span&gt; &lt;span class="nv"&gt;PYTHONIOENCODING&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;cp1250 ./kodovani.py
&lt;span class="go"&gt;default encoding:  utf-8&lt;/span&gt;
&lt;span class="go"&gt;Loï v úin&lt;/span&gt;

&lt;span class="go"&gt;Loï v úinì&lt;/span&gt;
&lt;span class="go"&gt;(&amp;#39;cp1250&amp;#39;, &amp;#39;cp1250&amp;#39;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Default encoding zůstalo stejné, změnilo se jen kódování standardního
vstupu/výstupu. Jak tedy nastavit &lt;code&gt;defaultencoding&lt;/code&gt;?. To se totiž projeví u
otevřených souborů nebo například u vestavěné funkce &lt;code&gt;raw_input()&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Nejjednodušší je použít funkci &lt;code&gt;sys.setdefaultencoding()&lt;/code&gt;. Má to ale jeden malý
háček. Takto funkce je dostupná pouze při spuštění Pythonu. Dále se setkáme s
chybovým&amp;nbsp;hlášením.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="gt"&gt;Traceback (most recent call last):&lt;/span&gt;
&lt;span class="err"&gt;File &amp;quot;kodovani.py&amp;quot;, line 12, in &amp;lt;module&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt;    sys.setdefaultencoding(&amp;quot;utf-8&amp;quot;)&lt;/span&gt;
&lt;span class="go"&gt;AttributeError: &amp;#39;module&amp;#39; object has no attribute &amp;#39;setdefaultencoding&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;První fígl je použít funkci &lt;code&gt;reload()&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="nb"&gt;reload&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c"&gt;# to enable `setdefaultencoding` again&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setdefaultencoding&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;nebo&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nb"&gt;reload&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setdefaultencoding&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;UTF-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Druhý fígl je spustit Python s parametrem &lt;code&gt;-S&lt;/code&gt;. Ten zakáže automatický import
modulu &lt;code&gt;site&lt;/code&gt;, který výchozí znakovou sadu nastavuje a funkci
&lt;code&gt;setdefaultencoding&lt;/code&gt; poté&amp;nbsp;znepřístupní.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="c"&gt;#!/usr/bin/python2.7 -S&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setdefaultencoding&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;site&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Výše jsem uvedl řešení pro jeden konkrétní zdrojový kód. Pokud požadujeme
&lt;strong&gt;globální nastavení&lt;/strong&gt; stačí vytvořit soubor &lt;code&gt;sitecustomize.py&lt;/code&gt; a umístit ho
někam do &lt;code&gt;PYTHONPATH&lt;/code&gt; respektive do &lt;code&gt;sys.path&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setdefaultencoding&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;#39;UTF-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;dl&gt;
&lt;dt&gt;Odkazy:&lt;/dt&gt;
&lt;dd&gt;&lt;a href="http://stackoverflow.com/questions/11741574/how-to-set-the-default-encoding-to-utf-8-in-python"&gt;http://stackoverflow.com/questions/11741574/how-to-set-the-default-encoding-to-utf-8-in-python&lt;/a&gt;&lt;/dd&gt;
&lt;dd&gt;&lt;a href="http://stackoverflow.com/questions/2276200/changing-default-encoding-of-python"&gt;http://stackoverflow.com/questions/2276200/changing-default-encoding-of-python&lt;/a&gt;&lt;/dd&gt;
&lt;dd&gt;&lt;a href="http://stackoverflow.com/questions/7105441/how-to-set-default-encoding-in-python-setdefaultencoding-function-does-not-ex"&gt;http://stackoverflow.com/questions/7105441/how-to-set-default-encoding-in-python-setdefaultencoding-function-does-not-ex&lt;/a&gt;&lt;/dd&gt;
&lt;/dl&gt;</summary><category term="python"></category><category term="I/O"></category></entry><entry><title>Python pro zpracování signálů</title><link href="http://www.tlapicka.net/python-pro-zpracovani-signalu.html" rel="alternate"></link><updated>2014-04-09T13:21:00+02:00</updated><author><name>Marek Nožka</name></author><id>tag:www.tlapicka.net,2014-04-09:python-pro-zpracovani-signalu.html</id><summary type="html">&lt;p&gt;Vyšla kniha 
&lt;a href="https://www.springer.com/engineering/signals/book/978-3-319-01341-1"&gt;Python for Signal Processing&lt;/a&gt;.
Tato kniha je k dispozici jako 
&lt;a href="http://python-for-signal-processing.blogspot.cz/"&gt;blog&lt;/a&gt;
ale také  jako 
&lt;a href="http://ipython.org/notebook.html"&gt;IPython Notebook&lt;/a&gt;
&lt;a href="https://github.com/unpingco/Python-for-Signal-Processing"&gt;na Githubu&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Python se mi jako nástroj pro zpracování signálů opravdu moc líbí. Je to hlavně
díky knihovnám 
&lt;a href="http://www.numpy.org/"&gt;NumPy&lt;/a&gt;,
&lt;a href="http://scipy.org/"&gt;SciPy&lt;/a&gt; a 
&lt;a href="http://matplotlib.org"&gt;Matplotlib&lt;/a&gt;.
Kdysi jsem měl tu čest pracovat na &lt;a href="http://www.feec.vutbr.cz"&gt;&lt;span class="caps"&gt;VUT&lt;/span&gt; v Brně&lt;/a&gt; s
programem &lt;a href="https://cs.wikipedia.org/wiki/Matlab"&gt;Matlab&lt;/a&gt;. Práce s výše
zmíněnými knihovnami je vece&amp;nbsp;podobná. &lt;/p&gt;
&lt;p&gt;Python a jeho knihovny jsou zdarma a pro mé účely naprosto dostačující. Navíc
se nemusím učit další jazyk a jeho ekosystém, takže s Pythonem si vystačím při
programování malých konzolových udělátek, grafických aplikací, webu i
zpracování&amp;nbsp;signálů.&lt;/p&gt;
&lt;p&gt;Já jsem nedávno udělal &lt;a href="http://nbviewer.ipython.org/github/tlapicka/IPythonNotebooks/tree/master/"&gt;malý pokus o organizaci svých
poznámek&lt;/a&gt;
k výše zmíněným knihovnám, který je k dipozici na mém &lt;a href="http://hroch.spseol.cz/~nozka/python/matplotlib/"&gt;školním
webu&lt;/a&gt; a na
&lt;a href="https://github.com/tlapicka/IPythonNotebooks"&gt;Githubu&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Výstup vypadá opravdu velice pěkně: &lt;br /&gt;
&lt;img alt="Kvantovací šum" src="http://www.tlapicka.net/img/sum.png" /&gt;&lt;/p&gt;
&lt;p&gt;A využití není jen v technice: &lt;br /&gt;
&lt;img alt="Path parch demo" src="http://www.tlapicka.net/img/path_patch_demo.png" /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://matplotlib.org/gallery.html"&gt;Gallery&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://matplotlib.org/users/screenshots.html"&gt;Screenshots&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</summary><category term="python"></category><category term="zpracování signálů"></category></entry></feed>